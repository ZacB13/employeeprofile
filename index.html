<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Employee Profile Form</title>
  <!-- Cropper.js CSS -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.css" rel="stylesheet"/>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
    .container { max-width: 800px; margin: 0 auto; background: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
    .logo { text-align: center; margin-bottom: 10px; }
    .logo img { max-width: 150px; }
    h1 { text-align: center; color: #00477A; margin: 10px 0; letter-spacing: 1px; }
    .centered { text-align: center; margin-bottom: 20px; }
    .row { display: flex; gap: 20px; }
    .photo-box {
      width: 180px; height: 180px;
      border: 2px dashed #ccc;
      display: flex; align-items: center; justify-content: center;
      position: relative;
      background: #fafafa;
      overflow: hidden;
    }
    .photo-box img { max-width: 100%; max-height: 100%; }
    .photo-input { position: absolute; top: 0; left: 0; width: 100%; height: 100%; opacity: 0; cursor: pointer; }
    .fields { flex: 1; }
    .fields label { display: block; font-weight: bold; margin-top: 10px; }
    .fields input { width: 100%; padding: 8px; margin-top: 4px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
    .section { margin-top: 20px; }
    .section label { font-weight: bold; display: block; margin-bottom: 6px; }
    .section textarea { width: 100%; padding: 8px; height: 80px; border: 1px solid #ccc; border-radius: 4px; resize: vertical; box-sizing: border-box; background: #fafafa; }
    .submit-btn { margin-top: 30px; display: block; width: 100%; padding: 12px; font-size: 16px; background-color: #00477A; color: #fff; border: none; border-radius: 4px; cursor: pointer; }
    .submit-btn:active { background-color: #003b60; }
  </style>
</head>
<body>
  <div class="container">
    <div class="logo">
      <!-- Rename your logo file to logo.png and place it alongside this HTML -->
      <img src="logo.png" alt="Lake Glass & Mirror Logo">
    </div>
    <div class="centered">
      <label><strong>General Contractor:</strong></label>
      <input type="text" id="gc-name" name="gc-name" style="width: 45%;" placeholder="Company name">
      <label style="margin-left: 20px;"><strong>Job Name:</strong></label>
      <input type="text" id="job-name" name="job-name" style="width: 45%;" placeholder="Job name">
    </div>
    <h1>EMPLOYEE PROFILE</h1>
    <form id="profile-form">
      <div class="row">
        <div>
          <div class="photo-box" id="photo-box">
            <span>Click to add &amp; crop photo</span>
            <input type="file" accept="image/*" id="photo-input" class="photo-input">
          </div>
        </div>
        <div class="fields">
          <label for="emp-name">Name</label>
          <input type="text" id="emp-name" name="emp-name" required>
          <label for="emp-contact">Contact Info</label>
          <input type="text" id="emp-contact" name="emp-contact" required>
          <label for="years-lgm">Years with LG&amp;M</label>
          <input type="text" id="years-lgm" name="years-lgm">
          <label for="years-industry">Years in Industry</label>
          <input type="text" id="years-industry" name="years-industry">
          <label for="position">Position</label>
          <input type="text" id="position" name="position">
        </div>
      </div>
      <div class="section">
        <label for="notable-jobs">Notable Jobs</label>
        <textarea id="notable-jobs" name="notable-jobs"></textarea>
      </div>
      <div class="section">
        <label for="certificates">Certificates</label>
        <textarea id="certificates" name="certificates"></textarea>
      </div>
      <div class="section">
        <label for="qualifications">Qualifications</label>
        <textarea id="qualifications" name="qualifications"></textarea>
      </div>
      <div class="section">
        <label for="other-notes">Other Notes</label>
        <textarea id="other-notes" name="other-notes" style="height: 120px;"></textarea>
      </div>
      <button type="button" class="submit-btn" id="submit-btn">Submit</button>
    </form>
  </div>
  <!-- Cropper.js JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.js"></script>
  <!-- jsPDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      let cropper;
      const photoInput = document.getElementById('photo-input');
      const photoBox = document.getElementById('photo-box');
      photoInput.addEventListener('change', function() {
        const file = this.files[0]; if (!file) return;
        const reader = new FileReader();
        reader.onload = function(e) {
          photoBox.innerHTML = '';
          const img = document.createElement('img');
          img.id = 'photo-preview';
          img.src = e.target.result;
          photoBox.appendChild(img);
          cropper = new Cropper(img, {
            aspectRatio: 1,
            viewMode: 1,
            autoCropArea: 1,
            background: false,
            movable: true,
            zoomable: true
          });
        };
        reader.readAsDataURL(file);
      });

      document.getElementById('submit-btn').addEventListener('click', function() {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        // Add logo
        const logo = new Image();
        logo.onload = function() {
          doc.addImage(logo, 'PNG', 20, 10, 40, 40);
          generateContent();
        };
        logo.src = 'logo.png';

        function generateContent() {
          // Header text
          doc.setFontSize(12);
          doc.text(`General Contractor: ${document.getElementById('gc-name').value}`, 70, 20);
          doc.text(`Job Name: ${document.getElementById('job-name').value}`, 70, 28);
          doc.setFontSize(16);
          doc.text('EMPLOYEE PROFILE', 105, 45, null, null, 'center');
          // Cropped photo
          if (cropper) {
            const canvas = cropper.getCroppedCanvas({ width: 180, height: 180 });
            const photoData = canvas.toDataURL('image/jpeg');
            doc.addImage(photoData, 'JPEG', 20, 55, 40, 40);
          }
          // Fields
          doc.setFontSize(12);
          const labels = ['Name', 'Contact Info', 'Years with LG&M', 'Years in Industry', 'Position'];
          labels.forEach((label, i) => {
            const val = document.getElementById(label.toLowerCase().replace(/ /g, '-')).value || '';
            doc.text(`${label}: ${val}`, 70, 55 + i * 8);
          });
          let y = 55 + labels.length * 8 + 10;
          // Sections
          ['Notable Jobs', 'Certificates', 'Qualifications', 'Other Notes'].forEach(sec => {
            doc.setFont(undefined, 'bold');
            doc.text(sec, 20, y);
            doc.setFont(undefined, 'normal');
            const text = document.getElementById(sec.toLowerCase().replace(/ /g, '-')).value || '';
            const lines = doc.splitTextToSize(text, 170);
            doc.text(lines, 20, y + 6);
            y += lines.length * 6 + 12;
          });
          // Save and email
          const name = document.getElementById('emp-name').value || 'form';
          doc.save(`Employee_Profile_${name}.pdf`);
          window.location.href = `mailto:zacb@lakeglassandmirror.com?subject=Employee Profile - ${encodeURIComponent(name)}`;
        }
      });
    });
  </script>
</body>
</html>
